{% extends "layout.html" %} {% block title %}
<title>Manage Bookings</title>
{% endblock %} {% block styles %}
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
  rel="stylesheet"
/>
<style>
  /* Style for scrollable table */
  .table-responsive {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  .table-striped tbody tr:hover {
    background-color: #f1f1f1;
  }
</style>
{% endblock %} {% block content %}
<div class="container mt-4">
  <!-- Flash Messages -->
  <div>
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %} {% for category, msg in messages %}
    <p class="alert alert-{{ category }}">{{ msg }}</p>
    {% endfor %} {% endif %} {% endwith %}
  </div>

  <!-- Bookings Data Section -->
  <h1 class="mb-4" style="color: white">Manage Bookings</h1>

  <a href="{{ url_for('admindashboard') }}" class="btn btn-primary mt-3"
    >Back to Dashboard</a
  >
  <br /><br />

  {% if bookings %}
  <div class="table-responsive">
    <table class="table table-bordered table-striped">
      <thead class="thead-dark">
        <tr>
          <th>Booking ID</th>
          <th>Username</th>
          <th>Category</th>
          <th>Package</th>
          <th>Package Type</th>
          <th>Booking Date</th>
          <th>Total Price</th>
          <th>Payment Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for booking in bookings %}
        <tr>
          <td>{{ booking['bookingid'] }}</td>
          <td>{{ booking['username'] }}</td>
          <td>{{ booking['categoryname'] }}</td>
          <td>{{ booking['packagename'] }}</td>
          <td>{{ booking['packagetypename'] }}</td>
          <td>{{ booking['booking_date'] }}</td>
          <td>${{ booking['total_price'] }}</td>
          <td>{{ booking['payment_status'] }}</td>
          <td>
            <!-- Action Buttons -->
            <form
              action="{{ url_for('delete_bookings', bookingid=booking['bookingid']) }}"
              method="post"
              style="display: inline"
            >
              <button
                type="submit"
                class="btn btn-danger btn-sm d-flex align-items-center"
                onclick="return confirm('Are you sure you want to delete this booking?');"
              >
                <i class="fas fa-trash me-2"></i>
                Delete
              </button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <!-- Pagination Section -->
  <div class="pagination mt-4">
    {% if total_pages > 1 %}
    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        <!-- Previous Page Link -->
        {% if current_page > 1 %}
        <li class="page-item">
          <a
            class="page-link"
            href="{{ url_for('viewbookings', page=current_page - 1) }}"
            aria-label="Previous"
          >
            <span aria-hidden="true">&laquo; Previous</span>
          </a>
        </li>
        {% else %}
        <li class="page-item disabled">
          <a class="page-link" href="#" tabindex="-1" aria-disabled="true"
            >&laquo; Previous</a
          >
        </li>
        {% endif %}

        <!-- Pagination Range -->
        {% for page in page_range %}
        <li class="page-item {% if page == current_page %}active{% endif %}">
          <a class="page-link" href="{{ url_for('viewbookings', page=page) }}"
            >{{ page }}</a
          >
        </li>
        {% endfor %}

        <!-- Next Page Link -->
        {% if current_page < total_pages %}
        <li class="page-item">
          <a
            class="page-link"
            href="{{ url_for('viewbookings', page=current_page + 1) }}"
            aria-label="Next"
          >
            <span aria-hidden="true">Next &raquo;</span>
          </a>
        </li>
        {% else %}
        <li class="page-item disabled">
          <a class="page-link" href="#" tabindex="-1" aria-disabled="true"
            >Next &raquo;</a
          >
        </li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}
  </div>
  {% else %}
  <p>No bookings found.</p>
  {% endif %}
</div>
{% endblock %}
