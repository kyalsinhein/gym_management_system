{% extends "layout.html" %} {% block title %}
<title>Manage Contact Form Submissions</title>
{% endblock %} {% block styles %}
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
  rel="stylesheet"
/>
<style>
  /* Fixed column widths */
  .table th,
  .table td {
    text-align: center;
    white-space: nowrap;
  }

  .contact-id-column {
    max-width: 80px;
  }

  .user-id-column {
    max-width: 100px;
  }

  .username-column {
    max-width: 150px;
  }

  .email-column {
    max-width: 200px;
  }

  .reason-column {
    max-width: 120px;
  }

  .subject-column {
    max-width: 180px;
  }

  .description-column {
    max-width: 250px;
    white-space: normal; /* Allow line wrapping */
  }

  .actions-column {
    max-width: 200px;
    text-align: center;
  }

  .btn-sm {
    margin-right: 5px;
    border-radius: 5px;
    padding: 7px 15px;
    font-size: 14px;
    display: inline-flex;
    align-items: center;
  }

  .btn-sm i {
    font-size: 16px;
    margin-right: 5px;
  }

  .table-responsive {
    overflow-x: auto;
  }

  /* Responsive Styles */
  @media (max-width: 768px) {
    .btn-sm {
      font-size: 12px;
      padding: 6px 12px;
    }

    .btn-sm i {
      font-size: 14px;
    }
  }

  @media (max-width: 576px) {
    .btn-sm {
      font-size: 10px;
      padding: 5px 10px;
    }

    .btn-sm i {
      font-size: 12px;
    }
  }
</style>
{% endblock %} {% block content %}
<div class="container-fluid mt-4">
  <!-- Flash Messages -->
  <div>
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %} {% for category, msg in messages %}
    <p class="alert alert-{{ category }}">{{ msg }}</p>
    {% endfor %} {% endif %} {% endwith %}
  </div>

  <!-- Contact Form Data Section -->
  <h1 class="mb-4" style="color: white">Manage Contact Form Submissions</h1>
  <a href="{{ url_for('admindashboard') }}" class="btn btn-primary btn-sm mb-3">
    Back to Dashboard
  </a>

  {% if contact_forms %}
  <div class="table-responsive">
    <table class="table table-bordered table-striped">
      <thead class="thead-dark">
        <tr>
          <th class="contact-id-column">Contact ID</th>
          <th class="user-id-column">User ID</th>
          <th class="username-column">Username</th>
          <th class="email-column">User Email</th>
          <th class="reason-column">Reason</th>
          <th class="subject-column">Subject</th>
          <th class="description-column">Description</th>
          <th class="actions-column">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for contact in contact_forms %}
        <tr>
          <td class="contact-id-column">{{ contact['contactid'] }}</td>
          <td class="user-id-column">{{ contact['userid'] }}</td>
          <td class="username-column">{{ contact['username'] }}</td>
          <td class="email-column">{{ contact['useremail'] }}</td>
          <td class="reason-column">{{ contact['reason'] }}</td>
          <td class="subject-column">{{ contact['subject'] }}</td>
          <td class="description-column">{{ contact['description'] }}</td>
          <td class="actions-column">
            <!-- Action buttons -->
            <a
              href="{{ url_for('reply_contactform', contactid=contact['contactid']) }}"
              class="btn btn-primary btn-sm"
            >
              <i class="fas fa-reply"></i> Reply
            </a>
            <form
              action="{{ url_for('delete_contactform', contactid=contact['contactid']) }}"
              method="post"
              style="display: inline"
            >
              <button
                type="submit"
                class="btn btn-danger btn-sm"
                onclick="return confirm('Are you sure you want to delete this contact form?');"
              >
                <i class="fas fa-trash"></i> Delete
              </button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Pagination Section -->
  <div class="pagination mt-4">
    {% if total_pages > 1 %}
    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        {% if current_page > 1 %}
        <li class="page-item">
          <a
            class="page-link"
            href="{{ url_for('viewcontactform', page=current_page - 1) }}"
            aria-label="Previous"
          >
            &laquo; Previous
          </a>
        </li>
        {% endif %} {% for page in page_range %}
        <li class="page-item {% if page == current_page %}active{% endif %}">
          <a
            class="page-link"
            href="{{ url_for('viewcontactform', page=page) }}"
          >
            {{ page }}
          </a>
        </li>
        {% endfor %} {% if current_page < total_pages %}
        <li class="page-item">
          <a
            class="page-link"
            href="{{ url_for('viewcontactform', page=current_page + 1) }}"
            aria-label="Next"
          >
            Next &raquo;
          </a>
        </li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}
  </div>

  {% else %}
  <p>No contact form submissions found.</p>
  {% endif %}
</div>
{% endblock %}
